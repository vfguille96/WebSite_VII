<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../css/style_signin.css">
    <title>SignIn</title>
</head>
<body>
<form name="formSU" id="formSU" method="post" action="../php/signup.php">
    <fieldset>
        <legend>Sign Up</legend>
        <div>
            <p><label for="inputUser">Username: </label>
                <input type="text" name="user" id="inputUser" value="" autofocus="autofocus" required="required"/></p>
            <p><label for="inputPassword">Password: </label>
                <input type="password" name="inputPassword" id="inputPassword" value="" required="required"/></p>
            <p><label for="inputName">Name: </label>
                <input type="text" name="name" id="inputName" value="" autofocus="autofocus" required="required"/></p>
            <p><label for="inputSurname">Surname: </label>
                <input type="text" name="surname" id="inputSurname" value="" autofocus="autofocus" required="required"/>
            </p>
        </div>
        <button type="submit" id="send">Sign Up</button>
    </fieldset>
</form>
<script type="text/javascript">
    var regexpSQLInjection = '/[\\t\\r\\n]|(--[^\\r\\n]*)|(\\/\\*[\\w\\W]*?(?=\\*)\\*\\/)/gi';

    String.prototype.hashCode = function () {
        var hash = 0;
        if (this.length === 0) {
            return hash;
        }
        for (var i = 0; i < this.length; i++) {
            var char = this.charCodeAt(i);
            hash = ((hash << 5) - hash) + char;
            hash = hash & hash; // Convert to 32bit integer
        }
        return hash;
    };

    function checkName() {
        var name = document.getElementById('inputName');
        return !name.value.matches(regexpSQLInjection);
    }

    function checkSurname() {
        var surname = document.getElementById('inputSurname');
        return !surname.value.matches(regexpSQLInjection);
    }

    function checkUsername() {
        var username = document.getElementById('inputUser');
        return !username.value.matches(regexpSQLInjection);
    }

    function checkFormSignUp() {
        return checkName() && checkSurname() && checkUsername();
    }

    document.getElementById('formSU').onsubmit = function () {
        var txt = document.getElementById('inputPassword');
        txt.value = txt.value.hashCode();
        this.checkFormSignUp();
    };
</script>
</body>
</html>